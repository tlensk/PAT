# Scripts

This folder contains a set of custom scripts for obtaining and processing genomic sequences.
Below, one can find brief instructions for getting the PAT genomic sequences.

## 1. Download sequences

**PAT_ids.txt** contains a list of NCBI IDs for the PAT genomic sequences.
There are multiple ways of obtaining sequences from NCBI.
Here we describe, one of the possible solutions using our custom script with Biopython.
We assume that Python 3 and Biopython are already installed on the local machine where genomes are to be downloaded.

Save and **PATgb_fetch.py** in the same directory where PAT_ids.txt file is saved on the local machine.
Let this directory be the current working directory by opening a terminal (or a command line window) and navigating to this directory.
Next, run the following command:

```
python3 PATgb_fetch.py
```

The genomic sequences in GenBank format will be uploaded to the current working directory. 
Please make sure that there is enough space on the local machine to accomodate the sequences (**about 18 Gb**).  

<ins>Note:</ins> If **PATgb_fetch.py** script is terminated (e.g., because of network connection issues or long NCBI server response time) check **fLog.txt** file generated by the script in the current working directory for the last NCBI ID that was in processing. Next, check if the number of downloaded GenBank files matches the index number of this NCBI ID in the list (see **PAT_ids.txt**). If negative, restart the script. If positive, remove all the NCBI IDs listed before the last NCBI ID mentioned above in **PAT_ids.txt**, save the changed **PAT_ids.txt**, and restart **PATgb_fetch.py** script by running the command specified above. 

## 2. Check data quality

After the sequence download is complete, run **PATgb_extract.py** script to compare sequence record length with actual sequence length in the downloaded gb file. Also, the script calculates GC-content and the number of unrecognized/partially recognized nucleotides (e.g., N, W, or Y) in each sequence. The script reads in the list of NCBI IDs for the input sequences from **PAT_ids.txt** and analyze the corresponding GenBank files. The results of the analysis is recorded in a tab-separated **PAT_ids_sizecheck.txt** file generated by the script in the current working directory.  To run the script, use the following command in inside the directory that has the list file and all the GenBank files for genomic sequences:

```
python3 PATgb_extract.py
```
